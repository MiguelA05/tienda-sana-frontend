<body>
  <!-- Elementos decorativos -->
  <div class="decorative-circles">
    <div class="circle circle-one"></div>
    <div class="circle circle-two"></div>
    <div class="line"></div>
  </div>

  <div class="container">
    <div class="registration-card">
      <!-- Encabezado -->
      <div class="card-header">
        <i class="fa-solid fa-user-plus me-2"></i> Registro de Usuario
      </div>

      <form [formGroup]="registroForm" (ngSubmit)="registrar()"
        class="registration-form" novalidate>
        <div class="row">
          <!-- Cédula -->
          <div class="col-md-6">
            <div class="form-group">
              <div class="floating-field">
                <input
                  type="text"
                  class="form-control"
                  id="dni"
                  formControlName="dni"
                  placeholder=" "
                  maxlength="10"
                  pattern="[0-9]*"
                  [ngClass]="{'is-invalid': shouldShowError('dni')}" />
                <label for="dni" class="form-label">Cédula</label>
                <i class="fa-solid fa-id-card input-icon"></i>
              </div>
              @if (shouldShowError('dni')) {
              <div class="error-message">{{ getDniErrorMessage() }}</div>
              }
            </div>
          </div>

          <!-- Nombre -->
          <div class="col-md-6">
            <div class="form-group">
              <div class="floating-field">
                <input
                  type="text"
                  class="form-control"
                  id="nombre"
                  formControlName="nombre"
                  placeholder=" "
                  [ngClass]="{'is-invalid': shouldShowError('nombre')}" />
                <label for="nombre" class="form-label">Nombre</label>
                <i class="fa-solid fa-user input-icon"></i>
              </div>
              @if (shouldShowError('nombre')) {
              <div class="error-message">{{ getNombreErrorMessage() }}</div>
              }
            </div>
          </div>

          <!-- Dirección -->
          <div class="col-md-6">
            <div class="form-group">
              <div class="floating-field">
                <input
                  type="text"
                  class="form-control"
                  id="direccion"
                  formControlName="direccion"
                  placeholder=" "
                  [ngClass]="{'is-invalid': shouldShowError('direccion')}" />
                <label for="direccion" class="form-label">Dirección</label>
                <i class="fa-solid fa-location-dot input-icon"></i>
              </div>
              @if (shouldShowError('direccion')) {
              <div class="error-message">{{ getDireccionErrorMessage() }}</div>
              }
            </div>
          </div>

          <!-- Teléfono -->
          <div class="col-md-6">
            <div class="form-group">
              <div class="floating-field">
                <input
                  type="tel"
                  class="form-control"
                  id="telefono"
                  formControlName="telefono"
                  placeholder=" "
                  [ngClass]="{'is-invalid': shouldShowError('telefono')}" />
                <label for="telefono" class="form-label">Teléfono</label>
                <i class="fa-solid fa-phone input-icon"></i>
              </div>
              @if (shouldShowError('telefono')) {
              <div class="error-message">{{ getTelefonoErrorMessage() }}</div>
              }
            </div>
          </div>

          <!-- Email -->
          <div class="col-md-6">
            <div class="form-group">
              <div class="floating-field">
                <input
                  type="email"
                  class="form-control"
                  id="email"
                  formControlName="email"
                  placeholder=" "
                  [ngClass]="{'is-invalid': shouldShowError('email')}" />
                <label for="email" class="form-label">Email</label>
                <i class="fa-solid fa-envelope input-icon"></i>
              </div>
              @if (shouldShowError('email')) {
              <div class="error-message">{{ getEmailErrorMessage() }}</div>
              }

            </div>
          </div>

          <!-- Contraseña -->
          <div class="col-md-6">
            <div class="form-group position-relative">
              <div class="password-input-container">
                <input
                  [type]="isPasswordVisible ? 'text' : 'password'"
                  class="form-control"
                  id="contrasenia"
                  formControlName="contrasenia"
                  placeholder=" "
                  required
                  [ngClass]="{'is-invalid': shouldShowError('contrasenia')}" />
                <label for="contrasenia" class="form-label">Contraseña</label>
                <i class="fa-solid fa-lock input-icon"></i>
                <button
                  type="button"
                  class="btn-visibility"
                  (click)="togglePasswordVisibility()"
                  aria-label="Mostrar u ocultar contraseña">
                  <i
                    [class]="isPasswordVisible ? 'fa-solid fa-eye-slash' : 'fa-solid fa-eye'"></i>
                </button>
              </div>
              @if (shouldShowError('contrasenia')) {
              <div class="error-message">{{ getPasswordErrorMessage() }}</div>
              }
            </div>
          </div>

          <!-- Confirmar Contraseña -->
          <div class="col-md-6">
            <div class="form-group position-relative">
              <div class="password-input-container">
                <input
                  [type]="isConfirmPasswordVisible ? 'text' : 'password'"
                  class="form-control"
                  id="confirmacionContrasena"
                  formControlName="confirmacionContrasena"
                  placeholder=" "
                  required
                  [ngClass]="{'is-invalid': shouldShowError('confirmacionContrasena')}" />
                <label for="confirmacionContrasena"
                  class="form-label">Contraseña</label>
                <i class="fa-solid fa-lock input-icon"></i>
                <button
                  type="button"
                  class="btn-visibility"
                  (click)="toggleConfirmPasswordVisibility()"
                  aria-label="Mostrar u ocultar contraseña">
                  <i
                    [class]="isConfirmPasswordVisible ? 'fa-solid fa-eye-slash' : 'fa-solid fa-eye'"></i>
                </button>
              </div>
              @if (shouldShowError('confirmacionContrasena')) {
              <div class="error-message">{{ getConfirmPasswordErrorMessage()
                }}</div>
              }
            </div>
          </div>

          <!-- Alerta de error para contraseñas que no coinciden -->
          @if (shouldShowPasswordMismatchError()) {
          <div class="col-12">
            <div class="password-mismatch-alert">
              <i class="fa-solid fa-triangle-exclamation alert-icon"></i>
              Las contraseñas no coinciden
            </div>
          </div>
          }

        </div>

        <!-- Términos y condiciones -->
        <div class="form-check">
          <input
            type="checkbox"
            class="form-check-input"
            id="terms"
            formControlName="terms"
            [ngClass]="{'is-invalid': shouldShowError('terms')}" />
          <label class="form-check-label" for="terms">
            Acepto los <a
              href="https://docs.google.com/document/d/1ZekC9OX7apxYtDh7aOYmuk4TPXqtK3zBy7Ybm8Xv_Ss/edit?usp=sharing"
              class="terms-link">términos y condiciones</a>
          </label>
          @if (shouldShowError('terms')) {
          <div class="error-message">{{ getTermsErrorMessage() }}</div>
          }
        </div>

        <!-- Botón de registro -->
        <div class="button-container">
          <button type="submit" class="btn-primary"
            [disabled]="registroForm.invalid || isLoading">
            @if(isLoading) {
            <span class="spinner-border spinner-border-sm me-2" role="status"
              aria-hidden="true"></span>
            Procesando...
            } @else {
            <i class="fa-solid fa-user-plus me-2"></i>Registrarse
            }
          </button>
        </div>

        <!-- Link para iniciar sesión -->
        <div class="links-container">
          ¿Ya tienes cuenta? <a routerLink="/login">Iniciar sesión</a>
        </div>
      </form>
    </div>
  </div>
</body>